# 小数のわり算の筆算練習アプリ v1.1

**jimitas.com**が提供する小学生向けの小数のわり算筆算練習ツールです。ドラッグ&ドロップ操作で楽しく学習できます。

[![License](https://img.shields.io/badge/license-Educational-blue.svg)](https://jimitas.com)
[![Version](https://img.shields.io/badge/version-1.1-green.svg)](https://github.com/jimitas/warizan-hissan2)
[![Website](https://img.shields.io/badge/website-jimitas.com-orange.svg)](https://jimitas.com/wari-hissan2/)

## 🎯 アプリの特徴

### 📚 14種類の問題モード
#### 整数のわり算（6種類）
- **mode 0**: （２けた）÷（１けた） 商が１けた
- **mode 1**: （２けた）÷（１けた） 商が２けた
- **mode 2**: （３けた）÷（１けた） 商が２けた
- **mode 3**: （２けた）÷（２けた） 商が１けた
- **mode 4**: （３けた）÷（２けた） 商が１けた
- **mode 5**: （３けた）÷（２けた） 商が２けた

#### 小数÷整数（2種類）
- **mode 10**: ○○.○÷○（わり進み2回）例: 11.5÷5
- **mode 11**: ○○○.○÷○○（わり進み2回）例: 115.5÷55

#### 小数÷小数（4種類）
- **mode 20**: ○.○÷○.○=○（わり進み1回）例: 4.8÷1.2
- **mode 21**: ○○.○÷○.○=○（わり進み1回）例: 12.8÷1.6
- **mode 22**: ○○.○÷○.○=○○（わり進み2回）例: 89.3÷1.9
- **mode 23**: ○○.○÷○.○=○.○（わり進み2回）例: 36.6÷6.2

#### 特殊な計算（2種類）
- **mode 30**: ○○.○○÷○=○.○○（わり進み3回）例: 30.96÷6=5.16
- **mode 31**: 商を整数まで求め、あまりを出す 例: 208.5÷6=34あまり4.5

### 🎮 インタラクティブな学習体験
- **ドラッグ&ドロップ操作**: 数字をドラッグして筆算表に配置
- **リアルタイムフィードバック**: 正しい商を立てると色が変わる
- **音響効果**: 操作に応じた効果音でゲーム感覚を演出（プリロード対応で遅延なし）
- **ヒント機能**: 困ったときのサポート機能
- **答え合わせ**: 完了時の正誤判定
- **コインシステム**: 正解するとコインが貯まる（答えを見た場合は増えません）
- **自分で問題を作る**: 被除数・除数を自由に入力して練習可能
- **自動パターン認識**: 整数÷整数の問題は自動でモードを判定
- **自由配置モード**: パターンに一致しない問題は自由配置で対応

### 📱 全デバイス対応
- **レスポンシブデザイン**: スマホ・タブレット・PC対応
- **タッチ操作**: スマートフォンでのタッチ操作に対応
- **直感的UI**: 年齢を問わず使いやすいインターフェース

## 🏫 教育的効果

### 学習目標
1. **たてる・かける・おろす・ひく**の基本操作の習得
2. 筆算の正しい手順の理解
3. **小数点の位置**を正しく理解する
4. 位取りの概念の定着
5. あまりのある割り算の理解
6. わり進む計算（小数第2位まで）の習得

### 対象学年
- **主な対象**: 小学校5年生（小数のわり算）
- 小学校4年生（整数のわり算）
- 基礎から応用まで段階的に学習可能

## 🚀 使用方法

### 基本操作（自動生成モード）
1. **問題の種類を選択**: 14種類の問題モードから選択
2. **「問題を出す」ボタン**: 選択したモードの問題を自動生成
3. **筆算実行**: 数字パレットから数字をドラッグ&ドロップ
4. **答え合わせ**: 完了後に正誤をチェック

### 自分で問題を作る
1. **被除数・除数を入力**: 式の欄に数値を入力
2. **「作る」ボタン**: 入力した値で問題を作成
3. **あまりの選択**: モーダルダイアログで「はい」または「いいえ」を選択
4. **パターン認識**:
   - 整数÷整数の場合 → 自動でmode 0〜5を判定
   - その他の場合 → 自由配置モードで対応
5. **筆算実行**: 数字をドラッグ&ドロップして解答

### 便利機能
- **消す**: 入力した数字を削除（答えを見たフラグもリセット）
- **全て消す**: すべてのデータをリセット
- **ヒント**: 商の最初の位をヒント表示（コイン獲得不可になります）
- **答えを見る**: 正解を確認（コイン獲得不可になります）
- **コインをリセット**: 貯まったコインをリセット

## 🛠️ 技術仕様

### フロントエンド
- **HTML5**: セマンティックマークアップ
- **CSS3**: レスポンシブデザイン・メディアクエリ
- **JavaScript (ES6+)**: モジュール化・非同期処理
- **Bootstrap 5**: UIフレームワーク

### 主要機能
- **Drag and Drop API**: ネイティブドラッグ&ドロップ
- **Touch Events**: モバイル端末対応
- **Howler.js**: 音響効果ライブラリ（プリロード機能付き）
- **LocalStorage**: コイン数の永続化保存
- **Bootstrap 5 Modal**: カスタムダイアログ（はい/いいえボタン）
- **Promise/Async-Await**: 非同期処理（音声プリロード、モーダル）

### ブラウザ対応
- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

## 📁 ファイル構成

```
wari-hissan2/
├── index.html              # メインHTML（SEO対策、構造化データ、Bootstrap 5 Modal）
├── style.css               # スタイルシート
├── index.js                # エントリーポイント（音声プリロード処理）
├── hissan.js               # メイン処理（hint_flag管理、イベントハンドラ）
├── createRandomNumber.js   # 問題自動生成（14種類のモード対応）
├── createTable.js          # テーブル作成（行数自動計算）
├── displayWriteTable.js    # 筆算表示（モード別ドロップエリア設定、自由配置モード）
├── displayInputNumber.js   # 入力欄表示
├── myAnswerUpdate.js       # 回答更新
├── checkAnswer.js          # 答え合わせ（コイン管理、hint_flag対応）
├── makeQuestion.js         # 手動問題作成（パターン認識、自由配置モード、モーダル）
├── se.js                   # 音響効果（プリロード機能）
├── howler.min.js          # 音響ライブラリ
└── images/
    ├── gomibako.png       # ごみ箱アイコン
    └── coin.png           # コインアイコン
```

## 🎨 デザインコンセプト

### UI/UX設計
- **シンプルな操作性**: 直感的に使える設計
- **視覚的フィードバック**: 操作結果の明確な表示
- **教育的配色**: 学習に集中できる配色選択
- **アクセシビリティ**: 幅広いユーザーに配慮

## 🔧 開発者向け情報

### セットアップ
```bash
git clone https://github.com/jimitas/warizan-hissan2.git
cd warizan-hissan2
# ローカルサーバーで起動（例: Live Server、Python http.server など）
# ブラウザで index.html を開く
```

### 主要関数
- `createRandomNumber()`: 問題数値生成（14モード対応）
- `makeQuestion()`: 手動問題作成（パターン認識、モーダル）
- `detectMode()`: パターン認識（整数÷整数のみ）
- `showAmariConfirmModal()`: あまりの確認モーダル（Promise対応）
- `calculateTableSize()`: テーブル行数計算（モード別）
- `createTable()`: 筆算テーブル作成
- `displayWriteTable()`: 問題表示（モード別、自由配置モード）
- `myAnswerUpdate()`: 回答チェック
- `checkAnswer()`: 最終判定（hint_flag対応、コイン管理）
- `preloadAllSounds()`: 音声プリロード（Promise対応）

### カスタマイズ
- 音響効果のオン/オフ切り替え
- 新しい難易度レベルの追加
- 視覚効果のカスタマイズ

## 📝 ライセンス

このプロジェクトは教育目的で開発されています。

## 🌐 関連リンク

- **開発元**: [jimitas.com](https://jimitas.com)
- **アプリURL**: [https://jimitas.com/wari-hissan2/](https://jimitas.com/wari-hissan2/)
- **GitHub**: [warizan-hissan2](https://github.com/jimitas/warizan-hissan2)

## 📞 お問い合わせ

ご質問・ご要望は[jimitas.com](https://jimitas.com)までお気軽にお問い合わせください。

## 📅 更新履歴

### v1.1 (2025年)
- 🚀 **iPad/タブレット最適化リリース**
- ✅ ドラッグ&ドロップのパフォーマンス大幅改善
  - numberSet()の最適化：クローン方式採用でDOM操作を削減
  - GPUアクセラレーション活用：スムーズな数字追従
  - イベントデリゲーション実装：メモリ使用量削減
- ✅ タッチ操作の改善
  - passive: false明示でiPadでの反応速度向上
  - CSS最適化：誤選択・誤タップ防止
- ✅ ユーザー体験の向上
  - ドロップ後の数字を再ドラッグ可能に
  - 数字パレットに戻せない制限（無限に使用可能）
  - ゴミ箱機能の改善
- ✅ メモリリーク対策
  - イベントリスナー重複問題を解消
  - 長時間使用でも安定動作
- ✅ コード品質向上
  - se.alert.stop()に統一
  - 一貫性のあるコード構造

### v1.0 (2024年)
- 🎉 **本番リリース**
- ✅ 14種類の問題モード完備
- ✅ コードクリーンアップ完了（デバッグログ削除、未使用コード削除）
- ✅ SEO対策完了（構造化データ、OGP、Twitter Card）
- ✅ レスポンシブデザイン完備（スマホ・タブレット・PC対応）
- ✅ 音声プリロード機能実装（遅延なし）
- ✅ LocalStorageによるコイン永続化
- ✅ 自動パターン認識機能
- ✅ 自由配置モード対応

---

**© 2024 jimitas.com - 小学生の学習をサポートする教育ツール**